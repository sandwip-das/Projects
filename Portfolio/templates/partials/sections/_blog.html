{% load static core_tags %}
<!-- Blog Section -->
<section id="{% if menu %}{{ menu.section_id }}{% else %}blog{% endif %}"
    class="py-10 bg-gradient-to-r from-[#1a1a2e] via-[#2e1a3d] to-[#4a3526] relative overflow-hidden scroll-mt-12 md:scroll-mt-14">
    <!-- Background Accents -->
    <div class="absolute top-0 right-0 w-[500px] h-[500px] bg-primary/5 rounded-full blur-[120px] pointer-events-none">
    </div>
    <div
        class="absolute bottom-0 left-0 w-[500px] h-[500px] bg-secondary/5 rounded-full blur-[120px] pointer-events-none">
    </div>

    <div class="max-w-7xl mx-auto px-8 sm:px-12 lg:px-16 relative z-10">
        <div class="text-center mb-6">
            <h2 class="text-3xl md:text-4xl font-bold mb-4">My <span class="text-primary">Blog</span></h2>
            {% if settings.blog_section_description %}
            <div class="max-w-2xl mx-auto">
                <p class="text-gray-400 text-lg leading-relaxed italic">
                    {{ settings.blog_section_description }}
                </p>
            </div>
            {% endif %}
            <div class="w-24 h-1 bg-gradient-to-r from-primary to-secondary mx-auto mt-6 rounded-full"></div>
        </div>

        <div class="relative group/slider">
            <!-- Navigation Button: Previous -->
            {% if blog_posts.count > 4 %}
            <button id="blog-prev-btn"
                onclick="document.getElementById('blog-slider').scrollBy({left: -350, behavior: 'smooth'})"
                class="absolute -left-4 md:-left-12 top-1/2 -translate-y-1/2 w-10 h-10 md:w-12 md:h-12 bg-white/10 backdrop-blur-md border border-white/20 rounded-full flex items-center justify-center text-white hover:bg-primary hover:border-primary transition-all duration-300 z-20 group-hover:scale-110 shadow-lg">
                <i class="fas fa-chevron-left"></i>
            </button>
            {% endif %}

            <!-- Grid Container -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 py-0">
                {% for post in blog_posts %}
                <div class="blog-card group h-full">
                    <a href="{% url 'blog_detail' post.slug %}" target="_blank"
                        class="glass-card h-full flex flex-col overflow-hidden transition-all duration-500 hover:shadow-2xl hover:shadow-[#ff7979]/40 border border-white/10 block">
                        <!-- Image with Hover Effect (Chronological Multiple Images) -->
                        <div
                            class="relative h-56 overflow-hidden flex overflow-x-auto snap-x snap-mandatory hide-scrollbar">
                            {% if post.images.exists %}
                            {% for img in post.images.all %}
                            <img src="{{ img.image.url }}" alt="{{ post.title }}"
                                class="w-full h-full object-cover flex-shrink-0 snap-center transition-transform duration-700 hover:scale-110 cursor-ew-resize">
                            {% endfor %}
                            {% else %}
                            <div
                                class="w-full h-full bg-gray-800 flex items-center justify-center flex-shrink-0 snap-center">
                                <i class="fas fa-image text-4xl text-gray-700"></i>
                            </div>
                            {% endif %}
                            <div class="absolute top-4 left-4">
                                <span
                                    class="px-3 py-1 bg-[#2ecc71]/80 backdrop-blur-md rounded-lg text-xs font-bold text-white uppercase tracking-wider">
                                    {{ post.category }}
                                </span>
                            </div>
                        </div>

                        <!-- Content -->
                        <div class="p-6 flex flex-col flex-grow">
                            <h3
                                class="text-xl font-bold text-white mb-2 group-hover:text-[#eb4d4b] transition-colors line-clamp-2">
                                {{ post.title }}
                            </h3>
                            <div class="text-white text-sm mb-4 flex-grow">{{ post.content|safe|truncatewords_html:15 }}
                            </div>

                            <!-- Footer Metrics -->
                            <div
                                class="mt-auto pt-3 border-t border-white/20 flex justify-between items-center overflow-x-auto text-sm">
                                <!-- Left side: Editor and Time in two lines -->
                                <div class="flex flex-col gap-1 text-white/70">
                                    <div class="flex items-center gap-1.5 shrink-0">
                                        <i class="fas fa-user text-[#2ecc71] text-xs"></i>
                                        <span class="font-medium truncate max-w-[120px] text-sm">
                                            Sandwip
                                        </span>
                                    </div>
                                    <div class="flex items-center gap-1.5 shrink-0">
                                        <i class="far fa-clock text-[#2ecc71] text-xs"></i>
                                        <span class="font-medium whitespace-nowrap text-xs">
                                            {{ post.created_at|date:"d M, Y" }}
                                        </span>
                                    </div>
                                </div>

                                <!-- Right side: Engagement Metrics in one line -->
                                <div class="flex items-center gap-1.5 shrink-0 h-full py-1">
                                    <div
                                        class="flex items-center gap-1.5 px-2.5 py-1 rounded-full border border-white/5 hover:border-white/10 hover:bg-white/5 transition-all text-gray-400 group">
                                        <i
                                            class="fas fa-eye text-[#2ecc71] text-xs group-hover:scale-110 transition-transform"></i>
                                        <span class="text-xs">{{ post.view_count }}</span>
                                    </div>
                                    <div
                                        class="flex items-center gap-1.5 px-2.5 py-1 rounded-full border border-white/5 hover:border-[#2ecc71]/30 hover:bg-[#2ecc71]/10 transition-all text-gray-400 group">
                                        <i
                                            class="fas fa-thumbs-up text-[#2ecc71] text-xs group-hover:scale-110 transition-transform"></i>
                                        <span class="text-xs">{{ post.like_count }}</span>
                                    </div>
                                    <div
                                        class="flex items-center gap-1.5 px-2.5 py-1 rounded-full border border-white/5 hover:border-yellow-400/30 hover:bg-yellow-400/10 transition-all text-gray-400 group">
                                        <i
                                            class="fas fa-comment text-yellow-400 text-xs group-hover:scale-110 transition-transform"></i>
                                        <span class="text-xs">{{ post.comment_count }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
                {% empty %}
                <div class="col-span-1 md:col-span-3 py-12 text-center glass-card border border-white/10">
                    <i class="fas fa-newspaper text-5xl text-gray-600 mb-4 block"></i>
                    <p class="text-gray-400">No blog posts found. Check back soon!</p>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</section>

<style>
    /* Hide scrollbar for Chrome, Safari and Opera */
    .hide-scrollbar::-webkit-scrollbar {
        display: none;
    }

    /* Hide scrollbar for IE, Edge and Firefox */
    .hide-scrollbar {
        -ms-overflow-style: none;
        /* IE and Edge */
        scrollbar-width: none;
        /* Firefox */
    }

    .blog-card .glass-card {
        background: rgba(255, 255, 255, 0.015);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border-radius: 1.5rem;
    }

    .blog-card:hover .glass-card {
        background: rgba(255, 255, 255, 0.03);
        border-color: rgba(255, 121, 121, 0.5);
        transform: translateY(-8px);
    }

    .line-clamp-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
</style>