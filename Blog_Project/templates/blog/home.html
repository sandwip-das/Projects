{% extends 'base.html' %}
{% load static %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section" {% if home_content.hero_background_image and home_content.hero_background_image.name
    !='site/default_hero.jpg' %}style="background-image: url('{{ home_content.hero_background_image.url }}');" {% endif
    %}>
    <div class="hero-overlay p-0"></div>
    <div class="container-fluid px-2 px-lg-4 hero-content">
        <div class="row w-100 mx-0">
            <!-- Marquee -->
            <div class="col-md-4">
                {% if home_content.marquee_text %}
                <div class="hero-card-transparent text-center animate-load">
                    <div class="marquee-container">
                        <div class="marquee-content">{{ home_content.marquee_text }}</div>
                    </div>
                </div>
                {% endif %}
            </div>
            <!-- Description -->
            <div class="col-md-4">
                <div class="hero-card-transparent text-center animate-load" style="animation-delay: 0.2s;">
                    <h3 class="fw-bold mb-2">{{ home_content.short_description }}</h3>
                </div>
            </div>
            <!-- Motto -->
            <div class="col-md-4">
                <div class="hero-card-transparent text-center animate-load" style="animation-delay: 0.4s;">
                    <p class="lead mb-0 text-white fw-bold">{{ home_content.motto }}</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Full Width Layout -->
<div class="container-fluid p-0 mb-3 space-top-fix">
    <div class="row g-0">
        <!-- Left Column: Trending (20% width on large screens) -->
        <div class="col-lg-2 d-none d-lg-block border-end bg-light-subtle">
            <div class="p-2 sticky-top" style="top: 80px; z-index: 1;">
                <h5 class="mb-4 text-gradient border-bottom pb-2 fw-bold"><i class="fas fa-chart-line me-2"></i>Trending
                </h5>
                {% for post in most_read|slice:":4" %}
                <div class="card mb-4 trending-card shadow-sm animate-hover" style="background-color: var(--card-bg);">
                    <div class="position-relative overflow-hidden">
                        {% if post.featured_image %}
                        <img src="{{ post.featured_image.url }}" class="card-img-top w-100 object-fit-cover"
                            style="height: 140px;" alt="{{ post.title }}">
                        {% else %}
                        <div class="bg-secondary card-img-top w-100" style="height: 140px;"></div>
                        {% endif %}

                        <!-- Category Badge -->
                        <!-- Category Badge -->
                        <div class="position-absolute top-0 end-0 m-2" style="z-index: 10;">
                            <span class="badge bg-white text-dark shadow-sm fw-bold" style="font-size: 0.7rem;">
                                {{ post.category.name }}
                            </span>
                        </div>
                    </div>

                    <div class="card-body p-3 d-flex flex-column">
                        <!-- Title -->
                        <h6 class="card-title fw-bold mb-2 small">
                            <a href="{{ post.get_absolute_url }}"
                                class="text-reset text-decoration-none stretched-link">
                                {{ post.title|truncatewords:10 }}
                            </a>
                        </h6>

                        <!-- Meta -->
                        <div class="small text-muted mb-2" style="font-size: 0.75rem;">
                            <span class="fw-semibold text-primary">{{ post.author.username }}</span>
                            <span class="mx-1">&bull;</span>
                            <span>{{ post.created_at|date:"M d, Y" }}</span>
                        </div>

                        <!-- Stats -->
                        <!-- Stats -->
                        <div class="mt-auto d-flex justify-content-between align-items-center w-100 position-relative border-top pt-2"
                            style="z-index: 2; font-size: 0.75rem;">
                            <span class="yt-btn p-1 px-2" style="font-size: 0.7rem;" title="Likes">
                                <i class="fas fa-thumbs-up me-1"></i>{{ post.total_likes }}
                            </span>
                            <span class="yt-btn p-1 px-2" style="font-size: 0.7rem;" title="Dislikes">
                                <i class="fas fa-thumbs-down"></i>
                            </span>
                            <span class="yt-btn p-1 px-2" style="font-size: 0.7rem;" title="Comments">
                                <i class="fas fa-comment me-1"></i>{{ post.total_comments }}
                            </span>
                            <span class="yt-btn p-1 px-2" style="font-size: 0.7rem;" title="Views">
                                <i class="fas fa-eye me-1"></i>{{ post.views_count }}
                            </span>
                        </div>
                    </div>
                </div>
                {% empty %}
                <p class="text-muted small">No posts yet.</p>
                {% endfor %}
            </div>
        </div>

        <!-- Center Column: Latest Stories (60% width on large screens) -->
        <div class="col-lg-8 px-4 py-2">
            <h5 class="mb-4 text-gradient border-bottom pb-2 fw-bold"><i class="fas fa-newspaper me-2"></i>Latest
                Stories</h5>

            {% if featured_latest %}
            <!-- Featured Latest Post (Minimized height) -->
            <div class="card mb-5 shadow-lg border-0 overflow-hidden main-featured-card animate-hover"
                style="background-color: var(--card-bg);">
                <div class="row g-0">
                    <!-- Image Section (60%) -->
                    <div class="col-md-7 position-relative" style="min-height: 280px;">
                        {% if featured_latest.featured_image %}
                        <img src="{{ featured_latest.featured_image.url }}"
                            class="w-100 h-100 object-fit-cover transition-zoom bg-dark position-absolute top-0 start-0"
                            alt="{{ featured_latest.title }}">
                        {% else %}
                        <div class="bg-secondary w-100 h-100 position-absolute top-0 start-0"></div>
                        {% endif %}

                        <!-- Category Badge -->
                        <div class="position-absolute top-0 end-0 m-3" style="z-index: 5;">
                            <span class="badge bg-white text-dark shadow-sm">{{ featured_latest.category.name }}</span>
                        </div>
                    </div>

                    <!-- Content Section (40%) -->
                    <div class="col-md-5">
                        <div class="card-body p-4 d-flex flex-column h-100">
                            <!-- Title -->
                            <h2 class="card-title fw-bold mb-2 h4">
                                <a href="{{ featured_latest.get_absolute_url }}"
                                    class="text-reset text-decoration-none">
                                    {{ featured_latest.title|truncatewords:10 }}
                                </a>
                            </h2>

                            <!-- Author & Date -->
                            <div class="text-muted mb-3 h6 small">
                                <span class="fw-semibold text-primary">{{ featured_latest.author.username }}</span>
                                <span class="mx-2">&bull;</span>
                                <span>{{ featured_latest.created_at|date:"M d, Y" }}</span>
                            </div>

                            <!-- Preview -->
                            <p class="card-text text-muted mb-3 flex-grow-1" style="font-size: 0.9rem;">
                                {{ featured_latest.content|striptags|truncatewords:20 }}
                            </p>

                            <!-- Bottom Config -->
                            <div
                                class="mt-auto border-top pt-3 d-flex align-items-center justify-content-between gap-2">
                                <!-- Main Call to Action (Left) -->
                                <a href="{{ featured_latest.get_absolute_url }}"
                                    class="btn btn-primary rounded-pill fw-bold shadow-sm px-4 stretched-link"
                                    style="white-space: nowrap; font-size: 0.9rem;">
                                    Read More
                                </a>

                                <!-- YouTube-style Interaction Buttons (Right) -->
                                <div class="d-flex align-items-center gap-1 position-relative" style="z-index: 2;">
                                    <span class="yt-btn px-2" title="Likes">
                                        <i class="fas fa-thumbs-up me-1"></i>{{ featured_latest.total_likes }}
                                    </span>
                                    <span class="yt-btn px-2" title="Dislikes">
                                        <i class="fas fa-thumbs-down"></i>
                                    </span>
                                    <span class="yt-btn px-2" title="Comments">
                                        <i class="fas fa-comment me-1"></i>{{ featured_latest.total_comments }}
                                    </span>
                                    <span class="yt-btn px-2" title="Views">
                                        <i class="fas fa-eye me-1"></i>{{ featured_latest.views_count }}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}

            <!-- Grid for Recent Posts -->
            <div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4">
                {% for post in recent_list %}
                <div class="col">
                    <div class="card h-100 border-0 shadow-sm animate-hover" style="background-color: var(--card-bg);">
                        <div class="position-relative overflow-hidden">
                            {% if post.featured_image %}
                            <img src="{{ post.featured_image.url }}" class="card-img-top transition-zoom"
                                alt="{{ post.title }}" style="height: 220px; width: 100%; object-fit: cover;">
                            {% else %}
                            <div class="card-img-top bg-secondary" style="height: 220px; width: 100%;"></div>
                            {% endif %}
                            <!-- Category Badge -->
                            <div class="position-absolute top-0 end-0 m-2" style="z-index: 5;">
                                <span class="badge bg-white text-dark shadow-sm">{{ post.category.name }}</span>
                            </div>
                        </div>
                        <div class="card-body p-3 d-flex flex-column">
                            <!-- Title (Max 10 words) -->
                            <h5 class="card-title fw-bold mb-2 h6">
                                <a href="{{ post.get_absolute_url }}"
                                    class="text-reset text-decoration-none stretched-link">
                                    {{ post.title|truncatewords:10 }}
                                </a>
                            </h5>

                            <!-- Editor Name | Posted Date Time -->
                            <div class="small text-muted mb-3">
                                <span class="fw-semibold text-primary">{{ post.author.username }}</span>
                                <span class="mx-1">&bull;</span>
                                <span>{{ post.created_at|date:"M d, Y" }}</span>
                            </div>

                            <!-- Interactions: Like, Dislike, Comments, View -->
                            <!-- Interactions: Like, Dislike, Comments, View -->
                            <div class="mt-auto d-flex justify-content-between align-items-center w-100 position-relative border-top pt-3"
                                style="z-index: 2;">
                                <div class="d-flex gap-2">
                                    <span class="yt-btn py-1 px-2" style="font-size: 0.75rem;" title="Likes">
                                        <i class="fas fa-thumbs-up me-1"></i>{{ post.total_likes }}
                                    </span>
                                    <span class="yt-btn py-1 px-2" style="font-size: 0.75rem;" title="Dislikes">
                                        <i class="fas fa-thumbs-down"></i>
                                    </span>
                                </div>
                                <div class="d-flex gap-2">
                                    <span class="yt-btn py-1 px-2" style="font-size: 0.75rem;" title="Comments">
                                        <i class="fas fa-comment me-1"></i>{{ post.total_comments }}
                                    </span>
                                    <span class="yt-btn py-1 px-2" style="font-size: 0.75rem;" title="Views">
                                        <i class="fas fa-eye me-1"></i>{{ post.views_count }}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% empty %}
                {% if not featured_latest %}
                <div class="col-12 text-center p-5">
                    <p class="text-muted">No posts available.</p>
                </div>
                {% endif %}
                {% endfor %}
            </div>
        </div>

        <!-- Right Column: Resources (20% width on large screens) -->
        <div class="col-lg-2 border-start bg-light-subtle">
            <div class="p-4 sticky-top" style="top: 80px; z-index: 1;">
                <h5 class="mb-4 text-gradient border-bottom pb-2 fw-bold"><i class="fas fa-link me-2"></i>Resources</h5>
                <div class="list-group list-group-flush shadow-sm rounded-3 overflow-hidden mb-4">
                    {% for link in links %}
                    <a href="{{ link.url }}"
                        class="list-group-item list-group-item-action bg-card text-reset d-flex align-items-center py-3 border-bottom animate-hover">
                        <span
                            class="rounded-circle bg-light text-primary me-2 d-flex align-items-center justify-content-center border"
                            style="width:25px;height:25px"><i class="fas fa-external-link-alt small"
                                style="font-size: 0.6rem;"></i></span>
                        <span class="fw-medium small">{{ link.title }}</span>
                    </a>
                    {% empty %}
                    <p class="text-muted p-3 small">No links available.</p>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}